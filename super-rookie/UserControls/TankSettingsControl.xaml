<UserControl x:Class="super_rookie.UserControls.TankSettingsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <StackPanel>
        <TextBlock Text="이름:" FontWeight="Bold" Margin="0,10,0,5"/>
        <TextBox Text="{Binding SelectedTank.Name, Mode=OneWay}" 
                 IsReadOnly="True" 
                 Margin="0,0,0,10" 
                 Padding="5"/>
        
        <TextBlock Text="용량 (L):" FontWeight="Bold" Margin="0,10,0,5"/>
        <TextBox Text="{Binding SelectedTank.Capacity}" 
                 Margin="0,0,0,10" 
                 Padding="5"/>
        
        <TextBlock Text="현재량 (L):" FontWeight="Bold" Margin="0,10,0,5"/>
        <TextBox Text="{Binding SelectedTank.Amount}" 
                 Margin="0,0,0,10" 
                 Padding="5"/>
        
        <!-- 밸브 관리 섹션 -->
        <TextBlock Text="밸브 관리:" FontWeight="Bold" Margin="0,20,0,5"/>
        
        <!-- 밸브 추가 -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
            <ComboBox x:Name="ValveSelectionComboBox"
                      ItemsSource="{Binding AvailableValves}"
                      DisplayMemberPath="Name"
                      Width="200"
                      Margin="0,0,10,0"/>
            <Button Content="밸브 추가" 
                    Command="{Binding AddValveToTankCommand}"
                    CommandParameter="{Binding SelectedItem, ElementName=ValveSelectionComboBox}"
                    Padding="10,5"/>
        </StackPanel>
        
        <!-- 탱크의 밸브 리스트 -->
        <TextBlock Text="연결된 밸브:" FontWeight="Bold" Margin="0,10,0,5"/>
        <ScrollViewer MaxHeight="150" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Margin="0,0,0,10">
            <ItemsControl ItemsSource="{Binding SelectedTank.Valves}" Cursor="">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border BorderBrush="#28A745" 
                                BorderThickness="1" 
                                Margin="2" 
                                Padding="6" 
                                CornerRadius="3"
                                Background="#F8FFF9">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding Name}" 
                                               FontWeight="Bold" 
                                               FontSize="11"/>
                                    <TextBlock Text="{Binding Direction}" 
                                               FontSize="9" 
                                               Foreground="#6C757D"/>
                                    <TextBlock Text="{Binding FlowRate, StringFormat='{}{0}L/s'}" 
                                               FontSize="9" 
                                               Foreground="#6C757D"/>
                                </StackPanel>
                                
                                <Button Grid.Column="1" 
                                        Content="✕" 
                                        Width="20" 
                                        Height="20" 
                                        FontSize="10"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Command="{Binding DataContext.RemoveValveFromTankCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                        CommandParameter="{Binding}"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        
        <Button Content="저장" 
                Command="{Binding SaveSettingsCommand}"
                HorizontalAlignment="Stretch" 
                Margin="0,20,0,0" 
                Padding="10,5"/>
    </StackPanel>
</UserControl>
